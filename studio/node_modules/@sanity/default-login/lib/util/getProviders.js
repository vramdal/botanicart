'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getProviders;

var _client = require('part:@sanity/base/client');

var _client2 = _interopRequireDefault(_client);

var _defaultLogin = require('config:@sanity/default-login');

var _defaultLogin2 = _interopRequireDefault(_defaultLogin);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function getProviders() {
  const config = _defaultLogin2.default || {};
  return _client2.default.request({
    uri: '/auth/providers',
    withCredentials: true
  }).then(res => {
    const providers = res.providers,
          thirdPartyLogin = res.thirdPartyLogin;

    const customProviders = (config.providers && config.providers.entries ? config.providers.entries : []).map(provider => {
      provider.custom = true;
      provider.supported = thirdPartyLogin;
      return provider;
    });
    if (customProviders.length && config.providers && config.providers.mode === 'replace') {
      return Promise.resolve(customProviders);
    }
    return providers.concat(customProviders);
  });
}